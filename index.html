<!DOCTYPE html>
<html lang="en">
<head>
	<!-- https://app-manifest.firebaseapp.com/?ref=hackernoon.com -->
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<link rel="stylesheet" href="./css/uikit.min.css" />
	<link rel="stylesheet" href="./css/index.css">
	<link rel="shortcut icon" href="./favicon.ico">


	<link rel="manifest" href="./manifest.json">
	<!-- Support for safari -->
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-status-bar-style" content="black">
	<meta name="apple-mobile-web-app-title" content="Home Remote">
	<link rel="apple-touch-icon" href="./launcher-icon-2x.png" sizes="92x92">
	<!-- <link rel="apple-touch-icon" href="/src/images/icons/apple-icon-57x57.png" sizes="57x57"> Add the rest of the icons, the browser will -->
	<link rel="apple-touch-icon" href="./launcher-icon-3x.png" sizes="144x144">
	<!-- Support for internet explorer -->
	<meta name="msapplication-TitleImage" content="./launcher-icon-2x.png">
	<meta name="msapplication-TitleColor" content="#3f51b5">
	<meta name="theme-color" content="#3f51b5">
  <title>Home Remote</title>
</head>
<body>
	<noscript>
		You need to enable JavaScript to run this app.
	</noscript>	
	
	<section class="app-root">
	</section>



	<section>
		<!-- This is the modal -->
		<div id="my-id" uk-modal>
			<div class="uk-modal-dialog uk-modal-body">
					<h2 class="uk-modal-title"></h2>
					<button class="uk-modal-close" type="button"></button>
			</div>
		</div>
	</section>



	<script>
    if ('serviceWorker' in navigator) {
			window.addEventListener('load', function() {
				navigator.serviceWorker.register('sw.js')
				.then(function(registration) {
					console.log('Worker registration successful', registration.scope);
				}, function(err) {
					console.log('Worker registration failed', err);
				})
				.catch(function(err) {
					console.log(err);
				});
			});
		} else {
			console.log('Service Worker is not supported by browser.');
		}
	</script>

	<script src="./js/mustache.min.js"></script>
	<script src="./js/uikit.min.js"></script>
	<script src="./js/uikit-icons.min.js"></script>
	<script src="./js/templates.js"></script>
	<script src="./js/keys.js"></script>
	<script src="./js/ws.js"></script>
	<script>
		const ws = new DeviceWebsocket()
		ws.connect();
		const data = {
			'groups': Object.keys(remoteKeys).map(objKey => {
				let res = { 'name': objKey }; 
				res['entries'] = remoteKeys[objKey]; 
				return res;
			})
		}
		console.log(data)
		html = Mustache.render(template, data);
		document.querySelector(".app-root").innerHTML = html	

		function fct(keyCode){
			console.log(keyCode)
			ws.applyKey(keyCode)
		}

		// document.querySelector("button").addEventListener('click', ()=>{
		// 	sendMessage("hhello")
		// 	.then((res)=>console.log(res))
		// 	.catch((res)=>console.error(res))
		// })
	</script>
  
</body>
</html>